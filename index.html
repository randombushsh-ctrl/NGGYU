<!DOCTYPE html>
<html>
<head>
    <style>
        /* ... (Twój CSS pozostaje bez zmian) ... */
    </style>
</head>
<body id="body">
    <!-- Nakładka startowa -->
    <div id="play-overlay">
        <button id="start-button" onclick="startExperience()">START</button>
        <div id="loading">Ładowanie danych...</div>
    </div>

    <!-- Treść strony -->
    <div id="content" style="display:none">
        <h1>ELO MORDO</h1>

        <!-- Kontener na wideo -->
        <div id="video-container">
            <video id="main-video" playsinline loop>
                <source src="movie.mp4" type="video/mp4">
            </video>
            <div id="overlay"></div>
        </div>

        <div id="hearts-container"></div>
        
        <button id="add-heart-btn" onclick="addHeart()">NO DAJ SERDUSZKO MORDO ❤️</button>

        <!-- Liczniki na dole -->
        <div class="counters">
            <div class="counter">Wejścia: <span id="visit-counter">0</span></div>
            <div class="counter">Serduszka: <span id="heart-counter">0</span></div>
        </div>

        <!-- Przycisk dźwięku -->
        <button id="sound-button" onclick="toggleSound()">🔊</button>
    </div>

    <script>
        // KONFIGURACJA SKRYPTU GOOGLE
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwOB45wtuF2suVO2Y7aWQrymzmVxLd_SlkeSolAZ135zP4zsJqR_XMamMdRfTB1gmoe/exec';

        // Funkcje do obsługi liczników
        async function fetchCounters() {
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getCounters`);
                const data = await response.json();
                document.getElementById('visit-counter').textContent = data.visits;
                document.getElementById('heart-counter').textContent = data.hearts;
            } catch (error) {
                console.error('Błąd pobierania liczników:', error);
            }
        }

        async function incrementVisits() {
            try {
                await fetch(`${SCRIPT_URL}?action=incrementVisits`, { method: 'POST' });
                await fetchCounters();
            } catch (error) {
                console.error('Błąd zwiększania wejść:', error);
            }
        }

        async function incrementHearts() {
            try {
                await fetch(`${SCRIPT_URL}?action=incrementHearts`, { method: 'POST' });
                await fetchCounters();
            } catch (error) {
                console.error('Błąd zwiększania serduszek:', error);
            }
        }

        // Ukryj ładowanie po 3 sekundach
        setTimeout(() => {
            document.getElementById('loading').style.display = 'none';
        }, 3000);

        // Funkcja uruchamiana po kliknięciu START
        async function startExperience() {
            // Ukryj nakładkę startową
            document.getElementById('play-overlay').style.display = 'none';
            
            // Pokaż treść
            document.getElementById('content').style.display = 'block';
            
            // Start tęczowego tła
            document.getElementById('body').classList.add('rainbow-bg');
            
            // Start wideo z dźwiękiem
            const video = document.getElementById('main-video');
            video.muted = false;
            video.play()
                .then(() => console.log("Wideo odtwarza się z dźwiękiem"))
                .catch(error => {
                    console.error("Błąd odtwarzania:", error);
                    video.muted = true;
                    video.play();
                });

            // Zwiększ licznik wejść
            await incrementVisits();
            
            // Sprawdź, czy użytkownik już dodał serduszko
            if (localStorage.getItem('heartGiven') === 'true') {
                document.getElementById('add-heart-btn').disabled = true;
                document.getElementById('add-heart-btn').textContent = "Dziękujemy!";
            }
        }

        // Automatyczne restartowanie wideo
        document.getElementById('main-video').addEventListener('ended', function() {
            this.currentTime = 0;
            this.play();
        }, false);

        // Funkcja włączająca/wyłączająca dźwięk
        function toggleSound() {
            const video = document.getElementById('main-video');
            video.muted = !video.muted;
            document.getElementById('sound-button').textContent = video.muted ? "🔇" : "🔊";
        }

        // Dodawanie serduszka
        async function addHeart() {
            if (localStorage.getItem('heartGiven') !== 'true') {
                await incrementHearts();
                localStorage.setItem('heartGiven', 'true');
                
                // Dodaj serduszko w UI
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = '❤️';
                heart.style.left = Math.random() * 80 + '%';
                document.getElementById('hearts-container').appendChild(heart);
                
                // Zaktualizuj przycisk
                document.getElementById('add-heart-btn').disabled = true;
                document.getElementById('add-heart-btn').textContent = "Dziękujemy!";
            }
        }

        // Inicjalizacja: pobierz liczniki przy ładowaniu strony
        document.addEventListener('DOMContentLoaded', fetchCounters);
    </script>
</body>
</html>
